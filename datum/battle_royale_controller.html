<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/battle_royale_controller - MonkeStation 2.0</title></head><body><header><a href="index.html">MonkeStation 2.0</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/battle_royale_controller.html#var">Var Details</a> - <a href="datum/battle_royale_controller.html#proc">Proc Details</a></header><main><h1>battle_royale_controller <aside>/<a href="datum.html">datum</a>/<a href="datum/battle_royale_controller.html">battle_royale_controller</a></aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L9"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 9"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/battle_royale_controller.html#var/active">active</a></th><td>Is this controller active and processing</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/active_for">active_for</a></th><td>How long has this datum been active for</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/current_data">current_data</a></th><td>Ref to the /datum/battle_royale_data we are currently using</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/data_datums">data_datums</a></th><td>list of our /datum/battle_royale_data datums</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/loot_tables">loot_tables</a></th><td>Assoc list of loot tables to use</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/max_duration">max_duration</a></th><td>What is the expected time for the entire station to be covered in storms</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/next_data_datum_value">next_data_datum_value</a></th><td>Tracker var for what data in data_datums we should use next</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/players">players</a></th><td>list of all our players assigned &quot;antag&quot; datums</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/prizes">prizes</a></th><td>Assoc list of prizes for the winner</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/signup_tracker">signup_tracker</a></th><td>A ref to our signup tracker, cant just use a poll because it breaks at numbers this high</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/spawnable_turfs">spawnable_turfs</a></th><td>The list of turfs valid for us to spawn players and loot on</td></tr><tr><th><a href="datum/battle_royale_controller.html#var/storm_controller">storm_controller</a></th><td>Ref to our barrier controller</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/build_data_datums">build_data_datums</a></th><td>Build our data_datums list, if fast is TRUE then we will use the faster pre-made battle_royale_data set, if custom is TRUE then we will use custom data if possible</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/calculate_drop_time">calculate_drop_time</a></th><td>Reduce the extra landing time of rare and super drops to make sure they wont land after royale end</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/calculate_spawned_loot_pods">calculate_spawned_loot_pods</a></th><td>Return how many loot pods to spawn</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/check_data">check_data</a></th><td>Return TRUE if we should move to our next data_datums entry. Otherwise, return FALSE</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/check_ending">check_ending</a></th><td>Check if we should end a battle royale</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/do_loot_drop">do_loot_drop</a></th><td>Actually spawn the loot and pod for it</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/end_royale">end_royale</a></th><td>End a battle royale</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/get_actually_spawnable_turf">get_actually_spawnable_turf</a></th><td>Filter through our spawnable_turfs until we get one we can actually spawn on</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/remove_grace">remove_grace</a></th><td>Remove grace period buffs and effects</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/setup">setup</a></th><td>Setup and start a royale</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/spawn_loot_pods">spawn_loot_pods</a></th><td>Spawns loot pods based on passed count</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/start_royale">start_royale</a></th><td>Start the royale</td></tr><tr><th><a href="datum/battle_royale_controller.html#proc/ui_data">ui_data</a></th><td>datum/battle_royale_controller/ui_static_data(mob/user)</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/active"><aside class="declaration">var </aside>active <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L11"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 11"></a></h3><p>Is this controller active and processing</p><h3 id="var/active_for"><aside class="declaration">var </aside>active_for <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L13"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 13"></a></h3><p>How long has this datum been active for</p><h3 id="var/current_data"><aside class="declaration">var </aside>current_data <aside>– /<a href="datum.html">datum</a>/<a href="datum/battle_royale_data.html">battle_royale_data</a></aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L21"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 21"></a></h3><p>Ref to the /datum/battle_royale_data we are currently using</p><h3 id="var/data_datums"><aside class="declaration">var </aside>data_datums <aside>– /alist</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L15"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 15"></a></h3><p>list of our /datum/battle_royale_data datums</p><h3 id="var/loot_tables"><aside class="declaration">var </aside>loot_tables <aside>– /static/list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L36"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 36"></a></h3><p>Assoc list of loot tables to use</p><h3 id="var/max_duration"><aside class="declaration">var </aside>max_duration <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L30"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 30"></a></h3><p>What is the expected time for the entire station to be covered in storms</p><h3 id="var/next_data_datum_value"><aside class="declaration">var </aside>next_data_datum_value <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L19"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 19"></a></h3><p>Tracker var for what data in data_datums we should use next</p><h3 id="var/players"><aside class="declaration">var </aside>players <aside>– /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L17"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 17"></a></h3><p>list of all our players assigned &quot;antag&quot; datums</p><h3 id="var/prizes"><aside class="declaration">var </aside>prizes <aside>– /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L25"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 25"></a></h3><p>Assoc list of prizes for the winner</p><h3 id="var/signup_tracker"><aside class="declaration">var </aside>signup_tracker <aside>– /<a href="obj.html">obj</a>/<a href="obj/effect/battle_royale_signup.html">effect/battle_royale_signup</a></aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L32"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 32"></a></h3><p>A ref to our signup tracker, cant just use a poll because it breaks at numbers this high</p><h3 id="var/spawnable_turfs"><aside class="declaration">var </aside>spawnable_turfs <aside>– /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L34"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 34"></a></h3><p>The list of turfs valid for us to spawn players and loot on</p><h3 id="var/storm_controller"><aside class="declaration">var </aside>storm_controller <aside>– /<a href="datum.html">datum</a>/<a href="datum/royale_storm_controller.html">royale_storm_controller</a></aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L23"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 23"></a></h3><p>Ref to our barrier controller</p><h2 id="proc">Proc Details</h2><h3 id="proc/build_data_datums"><aside class="declaration">proc </aside>build_data_datums<aside>(fast, custom)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L321"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 321"></a></aside></h3><p>Build our data_datums list, if fast is TRUE then we will use the faster pre-made battle_royale_data set, if custom is TRUE then we will use custom data if possible</p><h3 id="proc/calculate_drop_time"><aside class="declaration">proc </aside>calculate_drop_time<aside>(input_delay)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L376"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 376"></a></aside></h3><p>Reduce the extra landing time of rare and super drops to make sure they wont land after royale end</p><h3 id="proc/calculate_spawned_loot_pods"><aside class="declaration">proc </aside>calculate_spawned_loot_pods<aside>(seconds)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L272"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 272"></a></aside></h3><p>Return how many loot pods to spawn</p><h3 id="proc/check_data"><aside class="declaration">proc </aside>check_data<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L306"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 306"></a></aside></h3><p>Return TRUE if we should move to our next data_datums entry. Otherwise, return FALSE</p><h3 id="proc/check_ending"><aside class="declaration">proc </aside>check_ending<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L262"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 262"></a></aside></h3><p>Check if we should end a battle royale</p><h3 id="proc/do_loot_drop"><aside class="declaration">proc </aside>do_loot_drop<aside>(table, delay, announcement)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L380"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 380"></a></aside></h3><p>Actually spawn the loot and pod for it</p><h3 id="proc/end_royale"><aside class="declaration">proc </aside>end_royale<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/winner)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L236"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 236"></a></aside></h3><p>End a battle royale</p><h3 id="proc/get_actually_spawnable_turf"><aside class="declaration">proc </aside>get_actually_spawnable_turf<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L179"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 179"></a></aside></h3><p>Filter through our spawnable_turfs until we get one we can actually spawn on</p><h3 id="proc/remove_grace"><aside class="declaration">proc </aside>remove_grace<aside>(/<a href="mob.html">mob</a>/player, /<a href="datum.html">datum</a>/<a href="datum/action.html">action</a>/<a href="datum/action/cooldown.html">cooldown</a>/<a href="datum/action/cooldown/spell.html">spell</a>/<a href="datum/action/cooldown/spell/aoe.html">aoe</a>/knock/spell)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L227"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 227"></a></aside></h3><p>Remove grace period buffs and effects</p><h3 id="proc/setup"><aside class="declaration">proc </aside>setup<aside>(fast, custom, /<a href="mob.html">mob</a>/user)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L84"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 84"></a></aside></h3><p>Setup and start a royale</p><h3 id="proc/spawn_loot_pods"><aside class="declaration">proc </aside>spawn_loot_pods<aside>(count)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L296"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 296"></a></aside></h3><p>Spawns loot pods based on passed count</p><h3 id="proc/start_royale"><aside class="declaration">proc </aside>start_royale<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L158"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 158"></a></aside></h3><p>Start the royale</p><h3 id="proc/ui_data"><aside class="parent"><a title="/datum" href="datum.html#proc/ui_data">↑</a></aside>ui_data<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e8578eb37f64beb024e8b82c982cba9918712316/monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm#L431"><img src="git.png" width="16" height="16" title="monkestation/code/modules/admin/battle_royale/battle_royale_controller.dm 431"></a></aside></h3><p>datum/battle_royale_controller/ui_static_data(mob/user)</p></main><footer>tgstation.dme <a href="https://github.com/wraith-54321/Monkestation2.0/tree/e8578eb37f64beb024e8b82c982cba9918712316">e8578eb</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>