<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/controller/subsystem/gamemode - MonkeStation 2.0</title></head><body><header><a href="index.html">MonkeStation 2.0</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> â€” <a href="datum/controller/subsystem/gamemode.html#var">Var Details</a> - <a href="datum/controller/subsystem/gamemode.html#proc">Proc Details</a></header><main><h1>gamemode <aside>/<a href="datum.html">datum</a>/<a href="datum/controller/subsystem.html">controller/subsystem</a>/<a href="datum/controller/subsystem/gamemode.html">gamemode</a></aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L9"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 9"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/allow_pop_scaling">allow_pop_scaling</a></th><td>Whether we allow pop scaling. This is configured by config, or the storyteller UI</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/can_run_roundstart">can_run_roundstart</a></th><td>Are we able to run roundstart events</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/current_pop_scale_multipliers">current_pop_scale_multipliers</a></th><td>Associative list of active multipliers from pop scale penalty.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/current_roundstart_event">current_roundstart_event</a></th><td>What is our currently desired/selected roundstart event</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/current_storyteller">current_storyteller</a></th><td>Our storyteller. They progresses our trackboards and picks out events</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/event_frequency_multiplier">event_frequency_multiplier</a></th><td>Event frequency multiplier, it exists because wizard, eugh.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/event_pools">event_pools</a></th><td>Associative list of control events by their track category. Compiled in Init</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/event_track_points">event_track_points</a></th><td>Associative list of even track points.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/event_tracks">event_tracks</a></th><td>List of our event tracks for fast access during for loops.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/forced_next_events">forced_next_events</a></th><td>Associative list of tracks to forced event controls. For admins to force events (though they can still invoke them freely outside of the track system)</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/halted_storyteller">halted_storyteller</a></th><td>Whether the storyteller has been halted</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/last_point_gains">last_point_gains</a></th><td>Last point amount gained of each track. Those are recorded for purposes of estimating how long until next event.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/min_pop_thresholds">min_pop_thresholds</a></th><td>Minimum population thresholds for the tracks to fire off events.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/next_storyteller_process">next_storyteller_process</a></th><td>Next process for our storyteller. The wait time is STORYTELLER_WAIT_TIME</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/panel_page">panel_page</a></th><td>Page of the UI panel.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/point_gain_multipliers">point_gain_multipliers</a></th><td>Configurable multipliers for point gain over time.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/point_thresholds">point_thresholds</a></th><td>Point thresholds at which the events are supposed to be rolled, it is also the base cost for events.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/pop_scale_penalties">pop_scale_penalties</a></th><td>Associative list of pop scale penalties.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/pop_scale_thresholds">pop_scale_thresholds</a></th><td>Associative list of pop scale thresholds.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/ran_roundstart">ran_roundstart</a></th><td>Has a roundstart event been run</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/ready_players">ready_players</a></th><td>Ready players for roundstart events.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/roundstart_antag_minds">roundstart_antag_minds</a></th><td>List of new player minds we currently want to give our roundstart antag to</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/roundstart_event_view">roundstart_event_view</a></th><td>Whether we are viewing the roundstart events or not</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/roundstart_point_multipliers">roundstart_point_multipliers</a></th><td>Configurable multipliers for roundstart points.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/scheduled_events">scheduled_events</a></th><td>Events that we have scheduled to run in the nearby future</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/secret_storyteller">secret_storyteller</a></th><td>Is storyteller secret or not</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/selected_storyteller">selected_storyteller</a></th><td>Result of the storyteller vote/pick. Defaults to the guide.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/statistics_track_page">statistics_track_page</a></th><td>Current preview page for the statistics UI.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/storytellers">storytellers</a></th><td>List of all the storytellers. Populated at init. Associative from type</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#var/uncategorized">uncategorized</a></th><td>List of all uncategorized events, because they were wizard or holiday events</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/admin_panel">admin_panel</a></th><td>Panel containing information, variables and controls about the gamemode and scheduled event</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/calculate_ready_players">calculate_ready_players</a></th><td>We need to calculate ready players for the sake of roundstart events becoming eligible.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/can_inject_antags">can_inject_antags</a></th><td>Whether events can inject more antagonists into the round</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/event_panel">event_panel</a></th><td>Panel containing information and actions regarding events</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/get_antag_cap">get_antag_cap</a></th><td>Gets the number of antagonists the antagonist injection events will stop rolling after.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/get_antag_count">get_antag_count</a></th><td>Return the total point value of active antags</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/get_candidates">get_candidates</a></th><td>Gets candidates for antagonist roles.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/get_correct_popcount">get_correct_popcount</a></th><td>Gets the correct popcount, returning READY people if roundstart, and active people if not.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/get_valid_storytellers">get_valid_storytellers</a></th><td>return a weighted list of all storytellers that are currently valid to roll, if return_types is set then we will return types instead of instances</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/handle_post_setup_points">handle_post_setup_points</a></th><td>At this point we've rolled roundstart events and antags and we handle leftover points here.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/handle_post_setup_roundstart_events">handle_post_setup_roundstart_events</a></th><td>Second step of handlind roundstart events, happening after people spawn.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/handle_pre_setup_roundstart_events">handle_pre_setup_roundstart_events</a></th><td>Because roundstart events need 2 steps of firing for purposes of antags, here is the first step handled, happening before occupation division.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/load_config_vars">load_config_vars</a></th><td>Loads config values from game_options.txt</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/load_event_config_vars">load_event_config_vars</a></th><td>Loads json event config values from events.txt</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/make_antag_chance">make_antag_chance</a></th><td>Handles late-join antag assignments</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/post_setup">post_setup</a></th><td>Everyone should now be on the station and have their normal gear.  This is the place to give the special roles extra things</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/pre_setup">pre_setup</a></th><td>Attempts to select players for special roles the mode might have.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/refund_scheduled_event">refund_scheduled_event</a></th><td>Refunds and removes a scheduled event.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/remove_scheduled_event">remove_scheduled_event</a></th><td>Removes a scheduled event.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/resetFrequency">resetFrequency</a></th><td>Resets frequency multiplier.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/roll_pre_setup_points">roll_pre_setup_points</a></th><td>We roll points to be spent for roundstart events, including antagonists.</td></tr><tr><th><a href="datum/controller/subsystem/gamemode.html#proc/schedule_event">schedule_event</a></th><td>Schedules an event to run later.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/allow_pop_scaling"><aside class="declaration">var </aside>allow_pop_scaling <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L78"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 78"></a></h3><p>Whether we allow pop scaling. This is configured by config, or the storyteller UI</p><h3 id="var/can_run_roundstart"><aside class="declaration">var </aside>can_run_roundstart <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L163"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 163"></a></h3><p>Are we able to run roundstart events</p><h3 id="var/current_pop_scale_multipliers"><aside class="declaration">var </aside>current_pop_scale_multipliers <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L99"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 99"></a></h3><p>Associative list of active multipliers from pop scale penalty.</p><h3 id="var/current_roundstart_event"><aside class="declaration">var </aside>current_roundstart_event <aside>â€“ /<a href="datum.html">datum</a>/<a href="datum/round_event_control.html">round_event_control</a>/<a href="datum/round_event_control/antagonist.html">antagonist</a>/<a href="datum/round_event_control/antagonist/solo.html">solo</a></aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L158"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 158"></a></h3><p>What is our currently desired/selected roundstart event</p><h3 id="var/current_storyteller"><aside class="declaration">var </aside>current_storyteller <aside>â€“ /<a href="datum.html">datum</a>/<a href="datum/storyteller.html">storyteller</a></aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L20"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 20"></a></h3><p>Our storyteller. They progresses our trackboards and picks out events</p><h3 id="var/event_frequency_multiplier"><aside class="declaration">var </aside>event_frequency_multiplier <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L126"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 126"></a></h3><p>Event frequency multiplier, it exists because wizard, eugh.</p><h3 id="var/event_pools"><aside class="declaration">var </aside>event_pools <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L110"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 110"></a></h3><p>Associative list of control events by their track category. Compiled in Init</p><h3 id="var/event_track_points"><aside class="declaration">var </aside>event_track_points <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L28"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 28"></a></h3><p>Associative list of even track points.</p><h3 id="var/event_tracks"><aside class="declaration">var </aside>event_tracks <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L18"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 18"></a></h3><p>List of our event tracks for fast access during for loops.</p><h3 id="var/forced_next_events"><aside class="declaration">var </aside>forced_next_events <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L116"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 116"></a></h3><p>Associative list of tracks to forced event controls. For admins to force events (though they can still invoke them freely outside of the track system)</p><h3 id="var/halted_storyteller"><aside class="declaration">var </aside>halted_storyteller <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L136"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 136"></a></h3><p>Whether the storyteller has been halted</p><h3 id="var/last_point_gains"><aside class="declaration">var </aside>last_point_gains <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L36"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 36"></a></h3><p>Last point amount gained of each track. Those are recorded for purposes of estimating how long until next event.</p><h3 id="var/min_pop_thresholds"><aside class="declaration">var </aside>min_pop_thresholds <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L53"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 53"></a></h3><p>Minimum population thresholds for the tracks to fire off events.</p><h3 id="var/next_storyteller_process"><aside class="declaration">var </aside>next_storyteller_process <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L26"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 26"></a></h3><p>Next process for our storyteller. The wait time is STORYTELLER_WAIT_TIME</p><h3 id="var/panel_page"><aside class="declaration">var </aside>panel_page <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L131"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 131"></a></h3><p>Page of the UI panel.</p><h3 id="var/point_gain_multipliers"><aside class="declaration">var </aside>point_gain_multipliers <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L62"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 62"></a></h3><p>Configurable multipliers for point gain over time.</p><h3 id="var/point_thresholds"><aside class="declaration">var </aside>point_thresholds <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L44"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 44"></a></h3><p>Point thresholds at which the events are supposed to be rolled, it is also the base cost for events.</p><h3 id="var/pop_scale_penalties"><aside class="declaration">var </aside>pop_scale_penalties <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L90"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 90"></a></h3><p>Associative list of pop scale penalties.</p><h3 id="var/pop_scale_thresholds"><aside class="declaration">var </aside>pop_scale_thresholds <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L81"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 81"></a></h3><p>Associative list of pop scale thresholds.</p><h3 id="var/ran_roundstart"><aside class="declaration">var </aside>ran_roundstart <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L161"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 161"></a></h3><p>Has a roundstart event been run</p><h3 id="var/ready_players"><aside class="declaration">var </aside>ready_players <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L142"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 142"></a></h3><p>Ready players for roundstart events.</p><h3 id="var/roundstart_antag_minds"><aside class="declaration">var </aside>roundstart_antag_minds <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L153"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 153"></a></h3><p>List of new player minds we currently want to give our roundstart antag to</p><h3 id="var/roundstart_event_view"><aside class="declaration">var </aside>roundstart_event_view <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L133"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 133"></a></h3><p>Whether we are viewing the roundstart events or not</p><h3 id="var/roundstart_point_multipliers"><aside class="declaration">var </aside>roundstart_point_multipliers <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L70"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 70"></a></h3><p>Configurable multipliers for roundstart points.</p><h3 id="var/scheduled_events"><aside class="declaration">var </aside>scheduled_events <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L113"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 113"></a></h3><p>Events that we have scheduled to run in the nearby future</p><h3 id="var/secret_storyteller"><aside class="declaration">var </aside>secret_storyteller <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L150"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 150"></a></h3><p>Is storyteller secret or not</p><h3 id="var/selected_storyteller"><aside class="declaration">var </aside>selected_storyteller <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L22"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 22"></a></h3><p>Result of the storyteller vote/pick. Defaults to the guide.</p><h3 id="var/statistics_track_page"><aside class="declaration">var </aside>statistics_track_page <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L129"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 129"></a></h3><p>Current preview page for the statistics UI.</p><h3 id="var/storytellers"><aside class="declaration">var </aside>storytellers <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L24"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 24"></a></h3><p>List of all the storytellers. Populated at init. Associative from type</p><h3 id="var/uncategorized"><aside class="declaration">var </aside>uncategorized <aside>â€“ /list</aside> <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L123"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 123"></a></h3><p>List of all uncategorized events, because they were wizard or holiday events</p><h2 id="proc">Proc Details</h2><h3 id="proc/admin_panel"><aside class="declaration">proc </aside>admin_panel<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L870"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 870"></a></aside></h3><p>Panel containing information, variables and controls about the gamemode and scheduled event</p><h3 id="proc/calculate_ready_players"><aside class="declaration">proc </aside>calculate_ready_players<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L371"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 371"></a></aside></h3><p>We need to calculate ready players for the sake of roundstart events becoming eligible.</p><h3 id="proc/can_inject_antags"><aside class="declaration">proc </aside>can_inject_antags<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L279"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 279"></a></aside></h3><p>Whether events can inject more antagonists into the round</p><h3 id="proc/event_panel"><aside class="declaration">proc </aside>event_panel<aside>(/<a href="mob.html">mob</a>/user)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L988"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 988"></a></aside></h3><p>Panel containing information and actions regarding events</p><h3 id="proc/get_antag_cap"><aside class="declaration">proc </aside>get_antag_cap<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L248"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 248"></a></aside></h3><p>Gets the number of antagonists the antagonist injection events will stop rolling after.</p><h3 id="proc/get_antag_count"><aside class="declaration">proc </aside>get_antag_count<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L257"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 257"></a></aside></h3><p>Return the total point value of active antags</p><h3 id="proc/get_candidates"><aside class="declaration">proc </aside>get_candidates<aside>(be_special, job_ban, observers, ready_newplayers, living_players, required_time, inherit_required_time, midround_antag_pref, no_antags, /list/restricted_roles, /list/required_roles)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L283"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 283"></a></aside></h3><p>Gets candidates for antagonist roles.</p><h3 id="proc/get_correct_popcount"><aside class="declaration">proc </aside>get_correct_popcount<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L350"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 350"></a></aside></h3><p>Gets the correct popcount, returning READY people if roundstart, and active people if not.</p><h3 id="proc/get_valid_storytellers"><aside class="declaration">proc </aside>get_valid_storytellers<aside>(return_types)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L840"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 840"></a></aside></h3><p>return a weighted list of all storytellers that are currently valid to roll, if return_types is set then we will return types instead of instances</p><h3 id="proc/handle_post_setup_points"><aside class="declaration">proc </aside>handle_post_setup_points<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L417"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 417"></a></aside></h3><p>At this point we've rolled roundstart events and antags and we handle leftover points here.</p><h3 id="proc/handle_post_setup_roundstart_events"><aside class="declaration">proc </aside>handle_post_setup_roundstart_events<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L435"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 435"></a></aside></h3><p>Second step of handlind roundstart events, happening after people spawn.</p><h3 id="proc/handle_pre_setup_roundstart_events"><aside class="declaration">proc </aside>handle_pre_setup_roundstart_events<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L423"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 423"></a></aside></h3><p>Because roundstart events need 2 steps of firing for purposes of antags, here is the first step handled, happening before occupation division.</p><h3 id="proc/load_config_vars"><aside class="declaration">proc </aside>load_config_vars<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L773"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 773"></a></aside></h3><p>Loads config values from game_options.txt</p><h3 id="proc/load_event_config_vars"><aside class="declaration">proc </aside>load_event_config_vars<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L716"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 716"></a></aside></h3><p>Loads json event config values from events.txt</p><h3 id="proc/make_antag_chance"><aside class="declaration">proc </aside>make_antag_chance<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/character)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L578"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 578"></a></aside></h3><p>Handles late-join antag assignments</p><h3 id="proc/post_setup"><aside class="declaration">proc </aside>post_setup<aside>(report)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L540"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 540"></a></aside></h3><p>Everyone should now be on the station and have their normal gear.  This is the place to give the special roles extra things</p><h3 id="proc/pre_setup"><aside class="declaration">proc </aside>pre_setup<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L533"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 533"></a></aside></h3><p>Attempts to select players for special roles the mode might have.</p><h3 id="proc/refund_scheduled_event"><aside class="declaration">proc </aside>refund_scheduled_event<aside>(/<a href="datum.html">datum</a>/<a href="datum/scheduled_event.html">scheduled_event</a>/refunded)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L359"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 359"></a></aside></h3><p>Refunds and removes a scheduled event.</p><h3 id="proc/remove_scheduled_event"><aside class="declaration">proc </aside>remove_scheduled_event<aside>(/<a href="datum.html">datum</a>/<a href="datum/scheduled_event.html">scheduled_event</a>/removed)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L366"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 366"></a></aside></h3><p>Removes a scheduled event.</p><h3 id="proc/resetFrequency"><aside class="declaration">proc </aside>resetFrequency<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L512"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 512"></a></aside></h3><p>Resets frequency multiplier.</p><h3 id="proc/roll_pre_setup_points"><aside class="declaration">proc </aside>roll_pre_setup_points<aside>()  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L378"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 378"></a></aside></h3><p>We roll points to be spent for roundstart events, including antagonists.</p><h3 id="proc/schedule_event"><aside class="declaration">proc </aside>schedule_event<aside>(/<a href="datum.html">datum</a>/<a href="datum/round_event_control.html">round_event_control</a>/passed_event, passed_time, passed_cost, passed_ignore, passed_announce, _forced)  <a href="https://github.com/wraith-54321/Monkestation2.0/blob/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2/monkestation/code/modules/storytellers/gamemode_subsystem.dm#L445"><img src="git.png" width="16" height="16" title="monkestation/code/modules/storytellers/gamemode_subsystem.dm 445"></a></aside></h3><p>Schedules an event to run later.</p></main><footer>tgstation.dme <a href="https://github.com/wraith-54321/Monkestation2.0/tree/e87cd5865da73e1fc78dbf3ac640d3e7369d7fa2">e87cd58</a> (master) â€” <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>